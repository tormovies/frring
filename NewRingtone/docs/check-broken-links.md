# Проверка битых ссылок и картинок (локально)

Команда `check:broken-links` обходит страницы сайта (из sitemap или из файла путей), собирает все ссылки (`<a href>`) и картинки (`<img src>`), проверяет их доступность. Ответы HTTP 4xx/5xx и ошибки соединения считаются битыми.

## Перед запуском

Поднимите локальный сервер, чтобы по базовому URL отдавались страницы и sitemap:

```bash
php artisan serve
# По умолчанию http://127.0.0.1:3000
```

В `.env` задайте `APP_URL=http://127.0.0.1:3000` — он используется как базовый URL, если не передан `--url`.

## Примеры

```bash
# Проверка по sitemap.xml (первые 100 страниц), только внутренние ссылки/картинки
php artisan check:broken-links

# Свой URL и лимит страниц
php artisan check:broken-links --url=http://127.0.0.1:3000 --limit=50

# Список страниц из файла (см. docs/check-broken-links.example.txt)
php artisan check:broken-links --paths=docs/check-broken-links.example.txt

# Без лимита страниц (все из sitemap)
php artisan check:broken-links --limit=0

# Сохранить отчёт в файл
php artisan check:broken-links --out=storage/broken-links-report.md

# Проверять также внешние ссылки и картинки (медленно)
php artisan check:broken-links --external
```

## Опции

| Опция | Описание |
|-------|----------|
| `--url=` | Базовый URL (по умолчанию `APP_URL`) |
| `--paths=` | Файл со списком путей или URL (по одному на строку) |
| `--limit=` | Макс. страниц для проверки (по умолчанию 100, 0 = без лимита) |
| `--external` | Проверять и внешние ссылки/картинки |
| `--out=` | Путь к файлу для сохранения отчёта (markdown) |

По умолчанию проверяются только ресурсы на том же хосте, что и базовый URL.

**Код выхода:** 0 — битых нет, 1 — есть хотя бы одна битая ссылка или картинка.
